(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[558],{1684:(e,t,n)=>{Promise.resolve().then(n.bind(n,7696))},3673:()=>{},7696:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>s});var a=n(5155),r=n(2115);n(3673);var o=n(9326),l=n(63),i=n(5704);function u(e){let{children:t}=e,n=(0,l.useSearchParams)(),r=(null==n?void 0:n.get("tenant"))||i.env.NEXT_PUBLIC_TENANT_ID||"REPLACE_WITH_DEFAULT_HALL_OWNER_ID";return(0,a.jsx)(o.O,{tenantId:r,children:t})}function s(e){let{children:t}=e;return(0,a.jsx)("html",{lang:"en",children:(0,a.jsx)("body",{children:(0,a.jsx)(r.Suspense,{fallback:null,children:(0,a.jsx)(u,{children:t})})})})}},9326:(e,t,n)=>{"use strict";n.d(t,{O:()=>m,A:()=>g});var a=n(5155),r=n(2115),o=n(2078),l=n(9708),i=n(3885);let u=(0,o.Wp)({apiKey:"AIzaSyAXkJB5pymjqwcTDc5DtH_CbDtXPIslsao",authDomain:"bms-pro-e3125.firebaseapp.com",projectId:"bms-pro-e3125",storageBucket:"bms-pro-e3125.firebasestorage.app",messagingSenderId:"95517764192",appId:"1:95517764192:web:a674c4c1aa55c314b23105"}),s=(0,l._A)(u,{experimentalAutoDetectLongPolling:!0}),c=(0,i.xI)(u),d=(0,r.createContext)(void 0);function m(e){let{children:t,tenantId:n}=e,[o,u]=(0,r.useState)(null),[m,g]=(0,r.useState)(!0);(0,r.useEffect)(()=>{let e=(0,i.hg)(c,async e=>{if(e)try{var t,a,r;let o=(0,l.H9)(s,"customers",e.uid),d=(await (0,l.x7)(o)).data();if(!(null==d?void 0:d.tenantId)||d.tenantId!==n){await (0,i.CI)(c),u(null),localStorage.removeItem("booking_engine_user"),g(!1);return}let m={id:e.uid,name:(null==d?void 0:d.name)||e.displayName||(null!=(r=null==(t=e.email)?void 0:t.split("@")[0])?r:"User"),email:e.email||"",phone:(null==d?void 0:d.phone)||"",avatar:(null==d?void 0:d.avatar)||"https://ui-avatars.com/api/?name=".concat(encodeURIComponent((null==d?void 0:d.name)||(null==(a=e.email)?void 0:a.split("@")[0])||"User"),"&background=e63946&color=fff")};u(m),localStorage.setItem("booking_engine_user",JSON.stringify(m))}catch(e){u(null),localStorage.removeItem("booking_engine_user")}else u(null),localStorage.removeItem("booking_engine_user");g(!1)});return()=>e()},[n]);let p=async(e,t)=>{g(!0);try{return await (0,i.x9)(c,e,t),!0}catch(e){return!1}finally{g(!1)}},f=async(e,t,a,r)=>{g(!0);try{let{user:o}=await (0,i.eJ)(c,t,a),u={customerId:o.uid,tenantId:n,name:e,email:t,phone:r||"",avatar:"https://ui-avatars.com/api/?name=".concat(encodeURIComponent(e),"&background=e63946&color=fff"),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),role:"customer",status:"active",source:"booking-engine"};return await (0,l.BN)((0,l.H9)(s,"customers",o.uid),u),!0}catch(e){return!1}finally{g(!1)}},h=async()=>{try{await (0,i.CI)(c)}finally{u(null),localStorage.removeItem("booking_engine_user")}},v=async e=>{if(!o)return!1;g(!0);try{let t={...e,customerId:o.id,updatedAt:new Date().toISOString()};await (0,l.mZ)((0,l.H9)(s,"customers",o.id),t);let n={...o,...e};return u(n),localStorage.setItem("booking_engine_user",JSON.stringify(n)),!0}catch(e){return!1}finally{g(!1)}};return(0,a.jsx)(d.Provider,{value:{user:o,isAuthenticated:!!o,isLoading:m,login:p,register:f,logout:h,updateProfile:v},children:t})}function g(){let e=(0,r.useContext)(d);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}}},e=>{e.O(0,[978,992,794,820,441,255,358],()=>e(e.s=1684)),_N_E=e.O()}]);